import Figure from "@site/src/components/Figure";
import FigReference from "@site/src/components/FigureReference";
import Citation from "@site/src/components/Citation";
import CitationFootnote from "@site/src/components/CitationFootnote";
import Link from "@docusaurus/Link";
import NavLink from "@site/src/components/NavLink";
import addBaseUrl from "@docusaurus/useBaseUrl";

<NavLink 
  link="/toolboxes/internal-erosion-suite" 
  linkTitle="Internal Erosion Suite" 
></NavLink>

# General Overview

## Getting Started

Copy or download the toolbox file to the computer. To open the toolbox file, either:

- Find the file on the computer and double-click it. This opens the file in Microsoft Excel.
- Open Microsoft Excel and use the application to open the file: Once Microsoft Excel is open, go to the File menu at the top of the window and select Open.

The toolbox is an Excel binary workbook (.xlsb) that uses macros. You may need to enable the macros, either before opening the file or by clicking
“Enable Content” in the yellow Security Warning message bar with a shield icon that appears after the file is opened. The actual message in the
message bar will vary depending on the computer’s settings and installed add-ins. <FigReference parentDocId="108_1_1" figKey="enable-macros"></FigReference> displays examples of different wordings that may appear in the message bar.

<Figure
  parentDocId="108_1_1"
  docId="03-general-overview.mdx"
  figKey="enable-macros"
  src="/figures/toolbox-technical-manuals/backward-erosion-piping-progression/figure1.png"
  alt="Security warning message bars with the 'Enable Content' option to enable macros"
  caption="Security warning message bars with the 'Enable Content' option to enable macros."
></Figure>

## Organization

Although the toolbox does not provide a calculation cover sheet, adding one is strongly recommended. A calculation cover sheet captures project
information, a description and purpose of the calculation, the assumptions for critical input parameters, a summary of the major conclusion and
results, and a revision history.

Each toolbox has a similar appearance and organizational structure:

- The first worksheet, About, summarizes the purpose of the toolbox and gives contact information for the RMC software development team.
- The second worksheet, Terms and Conditions, contains the terms and conditions for use of the toolbox (IWR software).
- The third worksheet, Version History, contains the revision history. Semantic versioning is used in the format of MAJOR.MINOR.PATCH:
  - MAJOR - significant worksheet changes not compatible with previous versions.
  - MINOR - additional features or enhancements that do not fundamentally change the calculations.
  - PATCH - backward-compatible bug fixes.
- The fourth worksheet, References, lists the references cited for each calculation worksheet.

The workbook and worksheets are not protected to prevent unwanted changes. However, because the toolbox has user-defined functions (UDFs) and
subroutines in Visual Basic, you cannot directly copy worksheets to another workbook without potentially losing functionality. A note in a bold
red font at the upper right margin indicates if the selected worksheet includes such features.

At the top of each calculation worksheet, input information for the preparer and checker for quality control (QC) documentation and the calculation
title in case multiple copies of the worksheet are created for different analysis scenarios (<FigReference parentDocId="108_1_1" figKey="heading"></FigReference>).
The footer of each calculation worksheet contains the versionnumber,which can be cross-referenced with the revision history on the third worksheet.

<Figure
  parentDocId="108_1_1"
  docId="03-general-overview.mdx"
  figKey="heading"
  src="/figures/toolbox-technical-manuals/backward-erosion-piping-progression/figure2.png"
  alt="Calculation worksheet heading"
  caption="Calculation worksheet heading."
></Figure>

User-specified input includes values and selections from drop-down lists. User input cells are light yellow, and these cells are unprotected.
When cells use drop-down lists, a note in blue font in the right margin of the row alerts the user to use the drop-down list. Conditional formatting
applies a gray background to cells that are not based on a user selection. When a user-specified value or calculated value is outside of acceptable
ranges, the cell is orange to indicate caution to the user.

All units for user-specified input values are clearly labeled. Most user-specified input values use English units. However, values may be in metric
where metric units are more common in practice (e.g., particle size in millimeters or permeability in centimeters per second). The toolbox may convert
English units to metric units to perform some calculations or if required for a specific formula based on the reference material for the equation.

If the calculation worksheet is a function of headwater level, up to seven headwater and tailwater levels may be specified at the top of the worksheet.
Tailwater may be required to calculate the net hydraulic head and hydraulic gradient. Specify the elevation datum by selecting one of three options
from the drop-down list: ft-NAVD88, ft-NGVD29, and Other. The two datum selections include English units of length (feet). If Other is selected, provide
a user-specified datum along with feet (e.g., ft-MSL [Mean Sea Level]). <FigReference parentDocId="108_1_1" figKey="NAVD88"></FigReference>, <FigReference parentDocId="108_1_1" figKey="NGVD29"></FigReference>, and <FigReference parentDocId="108_1_1" figKey="datum"></FigReference> illustrate
the three possible scenarios.

<Figure
  parentDocId="108_1_1"
  docId="03-general-overview.mdx"
  figKey="NAVD88"
  src="/figures/toolbox-technical-manuals/backward-erosion-piping-progression/figure3.png"
  alt="Headwater and tailwater input: NAVD88"
  caption="Headwater and tailwater input: NAVD88."
></Figure>

<Figure
  parentDocId="108_1_1"
  docId="03-general-overview.mdx"
  figKey="NGVD29"
  src="/figures/toolbox-technical-manuals/backward-erosion-piping-progression/figure4.png"
  alt="Headwater and tailwater input: NGVD29"
  caption="Headwater and tailwater input: NGVD29."
></Figure>

<Figure
  parentDocId="108_1_1"
  docId="03-general-overview.mdx"
  figKey="datum"
  src="/figures/toolbox-technical-manuals/backward-erosion-piping-progression/figure5.png"
  alt="Headwater and tailwater input: User-specified datum"
  caption="Headwater and tailwater input: User-specified datum."
></Figure>

Most calculation worksheets break down complex analysis into computational steps following a logical sequence (<FigReference parentDocId="108_1_1" figKey="step-banner"></FigReference>). Some simpler
worksheets do not have steps. Generally, different methodologies are unique worksheets. Some worksheets may include multiple methodologies, which
are labeled as options (<FigReference parentDocId="108_1_1" figKey="option-banner"></FigReference>).

<Figure
  parentDocId="108_1_1"
  docId="03-general-overview.mdx"
  figKey="step-banner"
  src="/figures/toolbox-technical-manuals/backward-erosion-piping-progression/figure6.png"
  alt="Example of step banner"
  caption="Example of step banner."
></Figure>

<Figure
  parentDocId="108_1_1"
  docId="03-general-overview.mdx"
  figKey="option-banner"
  src="/figures/toolbox-technical-manuals/backward-erosion-piping-progression/figure7.png"
  alt="Example of option banner"
  caption="Example of option banner."
></Figure>

Some calculation worksheets can perform either a deterministic or probabilistic analysis. Although not required to perform a probabilistic
analysis, Palisade @RISK software (standalone version or as part of the Palisade DecisionTools Suite) can customize the probabilistic analysis.
A note appears in a bold red font at the upper right-hand margin of a calculation worksheet indicating if this feature is included with the toolbox.

User notes generally appear in the right margin of each calculation worksheet. Some notes are in blue or red font for heightened awareness. These
notes include references to source materials for equations, figures, tables, pages, etc. If the RMC modified the source material, the reference
citation says “adapted from” instead of “from.”

Tabular and/or graphical summaries are generally the primary output of the toolbox. The UDFs in the PlotScale module change the minimum and maximum
values of the x-axis and y-axis for charts. If the calculation worksheet is a function of headwater level, you can define up to five headwater levels
of interest and plot them as vertical reference lines. By selecting the chart and then selecting the Filter icon to display the filter pane, you can
choose which data series to display. This is useful when computing the results from multiple methodologies, but not all are applicable or desired to display.
